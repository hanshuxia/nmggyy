<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

    <link rel="shortcut icon" href="/${res}/resources/images/favicon.ico" type="image/x-icon">
    <script type="text/javascript" src="/${res}/resources/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/${res}/resources/js/layer.js"></script>

   <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://core.casicloud.com/styles/cloud/bootstrap.min2.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/base.css"/>
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/WdatePicker.css"/>
    <!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/html5media/1.1.8/html5media.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut  icon" type="image/x-icon" href="/${res}/resources/images/favicon.ico" media="screen"/>
   <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/base.css"/>
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/releasePower.css"/>
    <!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/html5media/1.1.8/html5media.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <script type="text/javascript" src="/thirdparty/jquery-placeholder/placeholder-ie9.js" ></script>
    <![endif]-->

    <link href="${resSys}/jqueryUI/jquery.ui.css" rel="stylesheet" type="text/css"/>
    <script src="${resSys}/jquery.js" type="text/javascript"></script>
    <script src="${resSys}/front.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/ckeditor/ckeditor.js" type="text/javascript"></script>
    <script src="${base}/res/common/js/jquery.ext.js" type="text/javascript"></script>
    <script src="${resSys}/jqueryUI/jquery-ui.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/swfupload.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/swfupload.queue.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/fileprogress.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/handlers.js" type="text/javascript"></script>
    <link href="${base}/thirdparty/swfupload/process.css" rel="stylesheet" type="text/css"/>

    <title>编辑维修需求</title>

    <style type="text/css">
        .tggl .fbgj-fj{border:0px none; text-indent:0; padding:0 15px;}
        .tggl .fbgj-fj td{line-height:24px; border:0px none; padding:0; text-indent:0;}
        .inquiry_main {
            width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.1);
            padding: 30px 30px 50px;
        }

        .form-horizontal {
            overflow: hidden;
        }

        .go-field-title {
            border-bottom: 1px dashed #ddd;
            margin: 0 10px 15px 10px;
            padding: 5px 15px;
        }

        .go-field-title h3 {
            border-left: 5px solid #ff6600;
            font-family: "microsoft yahei";
            font-size: 18px;
            line-height: 1.2;
            margin: 14px 0;
            padding-left: 10px;
        }

        .form_button {
            background-color: #e56826;
            color: #fff;
            display: inline-block;
            line-height: 38px;
            margin: 20px 8px;
            text-align: center;
            width: 120px;
            border: 0;
            border-radius: 3px;
        }

        .error {
            width: 300px;
            display: inline;
        }

        .form-control {
            width: 400px;
        }

        .contact-div {
            float: left;
            width: 490px;
        }

        .contact-check {
            float: left;
            width: 150px;
            height: 30px;
            line-height: 30px;
        }

        .labels {
            width: 150px;
            text-align: right;
        }

        .div-h-title {
            background-color: #2dc3e8;
            bottom: 0;
            content: "";
            display: block;
            left: -4px;
            max-width: 4px;
            overflow: hidden;
            position: absolute;
            top: 0;
            width: 4px;
        }

        table {
            border-collapse: collapse;
            width: 1000px;

        }

        table, td, th {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;

        }

        .form-group {
            margin-top: 30px;
            margin-bottom: 30px;
            margin-left: 40px;
        }


        .resourceAddInput {
            width: 320px;
        }

        textarea {
            vertical-align: top;
            width: 100%;
            height: 150px;
            margin-top: 10px;
        }

        div > input {
            align: center
        }

        .commentDiv {
            margin-left: 15%
        }
    </style>



    <script type="text/javascript">

        function saveRepair(pm) {
            $("#status").val(pm);
            document.repairForm.submit();
        }


        var _index = 1;
        function addInquiryP() {
            var tdNum = $("#table1 tr").size();
            var str = "<tr name='addpro'>"
                    + "<td name='indexId' style='display:none;'></td>"
                    + "<td><input type='text' value='' placeholder='最多30字符' maxlength='30' onblur='minganci($(this).val(), this)' name='repairNameStr' id='capandproname' style='width:160px' class='go-input-common'/></td>"
                    + "<td><input type='text'  value='' placeholder='最多30字符' maxlength='30' style='width:160px' name='machineTypeStr' id='capandprocode' onBlur='javascript:validateCapandprocode(this.value)' class='go-input-common'/></td>"
                    + "<td><input type='text'  value='' placeholder='必须为整数' maxlength='10' style='width:80px'  name='repairNumStr' id='repairNumStr' class='go-input-common'  onkeyup='calculation(this)' /></td>"
                    + "<td><input type='text'  value='' placeholder='' maxlength='10' style='width:90px' name='chargeunit' id='chargeunit' class='go-input-common'  /></td>"
                    + "<td><input type='text'  value='' placeholder='型号、要求等,最多30字符' name='repairRequestStr' maxlength='30'  class='go-input-common' style='width:160px'  class='go-input-common'></td>"
                    + "<td><input type='text'  value='' name='expectPriceStr' id='expectPriceStr' validate='{maxDecimalLen:2}' maxlength='10' value='0' style='width:80px' class='go-input-common' onkeyup='calculation(this)' /><input type='hidden' name='subTotal'></td>"
                    + "<td> <a href='javascript:void(0);'  onclick='delproduct(this);'>删除</a></td>"
                    + "</tr>";
            $("#table1").append(str);
            $("#table1").show();
            _index++;
            parent.getIframeHeight();
        }
        function validateCapandprocode(obj) {
            var reg = /^[0-9a-zA-Z\/\-]+$/;
            if (!reg.test(obj)) {
                layer.alert("产品编号请输入-、/或英文字符或数字!", {icon: 2});
            } else {
                minganci($(obj).val(), obj);
            }
        }

        //删除产品
        function delproduct(opt) {
            //console.log($(opt).parent())
            /* $(opt).parent().parent().remove();
             parent.getIframeHeight();
             calculation(opt); */
            if (confirm('确认删除询价对象？')) {
                $(opt).parent().parent().remove();
                calculation(opt);
            }

        }
        //取消按钮
        function quxiao() {
            $("#product").hide();
            $("#chanpin").find("tr[name='addpro']").remove();
            _index = 0;
        }
        //确认按钮
        function isOk() {
            //清空原有的节点
            $("#copyProduct").empty();
            //复制数据节点
            var copyJd = $("#chanpin").find("tr:gt(1)");
            //console.log(copyJd.html());
            copyJd.clone(true).appendTo("#copyProduct");
            $("#product").hide();
            $("#chanpin").find("tr[name='addpro']").remove();

            if ($("#copyProduct tr").length > 0) {
                $("#addButton").hide();
                $("#detailButton").show();
            } else {
                $("#addButton").show();
                $("#detailButton").hide();
            }
        }

        function calculation(obj) {
            var repairNumStr = $(obj).parent().parent().find("input[name='repairNumStr']").val();
            var price = $(obj).parent().parent().find("input[name='expectPriceStr']").val();
            if (price == '') {
// 			$(obj).parent().parent().find("input[name='expectPriceStr']").val('0');
                price = $(obj).parent().parent().find("input[name='expectPriceStr']").val();
            }
            //格式校验
            var re = /^[0-9]*[1-9][0-9]*$/;
            if (!re.test(repairNumStr)) {
                // $(obj).parent().parent().find("input[name='repairNumStr']").val($(obj).val().replace(/\D/g, ''));
                return;
            }
            var t = /^\d+(\.\d+)?$/;
            if (!t.test(price)) {
                $(obj).parent().parent().find("input[name='expectPriceStr']").val($(obj).val().replace(/[^\d.]/g, ""));
                return;
            }
            /** 设置计算期望总价的计算*/
            var counts = 0;
            $("tr[name='addpro'] #repairNumStr").each(function () {
                var count = Number($(this).val()) * parseFloat($(this).closest("tr[name='addpro']").find("#expectPriceStr").val());
                counts = count + counts;
            })
            $("#total").text(counts.toFixed(2));

            $("#expectPrice").val(counts.toFixed(2));
        }

        //上传图片
        function upload(n) {
            var of = $("#uploadFile" + n);
            //检查是否选择了图片
            if (of.val() == "") {
                alert('没有选择图片!');
                return;
            }
            //将file移动至上传表单
            $("#fileContent").empty();
            $("#fileContent").append(of);
            //复制一个file放至原处
            $("#ufc" + n).append(of.clone().attr("value", ""));
            //修改属性
            of.attr("id", "");
            of.attr("name", "uploadFile");
            //其他表单
            $("#ufFileName").val($("#fileName" + n).val());
            $("#ufWidth").val($("#zoomWidth" + n).val());
            $("#ufHeight").val($("#zoomHeight" + n).val());
            //先清除
            $("#ufMark").val("");
            $("#ufMark").val($("#mark" + n).val());
            $("#uploadNum").val(n);
            $("#uploadForm").submit();
        }
        //剪裁图片
        function imgCut(n) {
            if ($("#uploadImgPath" + n).val() == "") {
                alert('没有选择图片!');
                return;
            }
            var url = "v_image_area_select.jspx?uploadNum=" + n + "&imgSrcPath="
                    + $("#uploadImgPath" + n).val() + "&zoomWidth=" + $("#zoomWidth" + n).val() + "&zoomHeight=" + $("#zoomHeight" + n).val();
            window.open(url, "imgcut", "height=550, width=1000, top=0, left=0, toolbar=no, menubar=no, scrollbars=auto, resizable=yes,location=no, status=no");
        }
        //预览图片
        function previewImg(n) {
            var img = $("#uploadImgPath" + n).val();
            if (img != "") {
                if (img.indexOf("?") == -1) {
                    $("#preImg" + n).attr("src", img + "?d=" + new Date() * 1);
                } else {
                    $("#preImg" + n).attr("src", img + "&d=" + new Date() * 1);
                }
                if (!$("#preImg" + n).attr("noResize")) {
                    $("#preImg" + n).css("width", "auto");
                    $("#preImg" + n).css("height", "auto");
                }
            } else {
                $("#preImg" + n).removeAttr("src");
            }
        }
    </script>
    <form id="uploadForm" action="o_upload_image.jspx" method="post" enctype="multipart/form-data" target="hiddenIframe"
          style="display:none;width:0px;height:0px;">
        <span id="fileContent"></span>
        <input id="ufWidth" type="hidden" name="zoomWidth"/>
        <input id="ufHeight" type="hidden" name="zoomHeight"/>
        <input id="ufFileName" type="hidden" name="fileName"/>
        <input id="ufMark" type="hidden" name="mark"/>
        <input id="uploadNum" type="hidden" name="uploadNum"/>
    </form>
    <iframe name="hiddenIframe" frameborder="0" border="0" style="display:none;width:0px;height:0px;"></iframe>
    <script type="text/javascript">
        //上传附件
        function uploadAttachment(n) {
            var af = $('#attachmentFile' + n);
            //检查是否选择了文件
            if (af.val() == '') {
                $.alert("提示", '未选中文件!');
                return;
            }
            //将file移动至上传表单
            $('#attachmentContent').empty();
            $('#attachmentContent').append(af);
            //复制一个file放至原处
            $('#afc' + n).append(af.clone().attr('value', ''));
            $('#attachmentText' + n).attr('value', '');
            //修改属性
            af.attr('id', '');
            //其他表单
            $('#attachmentNum').val(n);
            $('#attachmentForm').submit();
        }
    </script>
    <script type="text/javascript">
        $.validator.methods.leafChannel = function (value, element, param) {
            var i = element.selectedIndex;
            return $(element.options[i]).attr("class") != "sel-disabled";
        }
        $(function () {

            var uploadPicsUrl = "o_swfPicsUpload.jspx";
            var uploadAttachsUrl = "o_swfAttachsUpload.jspx";
            //在firefox、chrome下，上传不能保留登录信息，所以必须加上jsessionid。
            var jsessionid = "${sessionId!}";
            if (jsessionid) {
                uploadPicsUrl += ";jsessionid=" + jsessionid;
                uploadAttachsUrl += ";jsessionid=" + jsessionid;
            }
            swfu = new SWFUpload({
                upload_url: uploadPicsUrl,
                flash_url: "${base}/thirdparty/swfupload/swfupload.swf",
                file_size_limit: "20 MB",
                file_types: "*.jpg;*.gif;*.png;*.bmp",
                file_types_description: "图片",
                file_queue_limit: 0,
                custom_settings: {
                    progressTarget: "fsUploadProgress",
                    cancelButtonId: "btnCancel"
                },
                debug: false,

                button_image_url: "${base}/thirdparty/swfupload/button_notext.png",
                button_placeholder_id: "spanButtonPlaceHolder",
                button_text: "<span class='btnText'>上传</span>",
                button_width: 84,
                button_height: 24,
                button_text_top_padding: 2,
                button_text_left_padding: 20,
                button_text_style: '.btnText{color:#666666;}',

                file_queued_handler: fileQueued,
                file_queue_error_handler: fileQueueError,
                file_dialog_complete_handler: fileDialogComplete,
                upload_progress_handler: uploadProgress,
                upload_error_handler: uploadError,
                upload_success_handler: uploadPicsSuccess,
                upload_complete_handler: uploadComplete,
                queue_complete_handler: queueComplete
            });
        });
        function uploadPicsSuccess(file, data) {
            var jsonData = eval("(" + data + ")");//转换为json对象
            if (jsonData.error != null) {
                $.alert("[@s.m 'global.prompt'/]", jsonData.error);
            } else {
                addPicLine();
                var index = picIndex - 1;
                imgUrl = jsonData.imgUrl;
                $("#preImg" + index).attr("src", "" + imgUrl);
                var imgSrc = parent.document.getElementById("preImg" + index);
                if (!$(imgSrc).attr("noResize")) {
                    $(imgSrc).css("width", "auto");
                    $(imgSrc).css("height", "auto");
                }
                $("#uploadImgPath" + index).val(imgUrl);
            }
        }
        function uploadAttachSuccess(file, data) {
            var jsonData = eval("(" + data + ")");//转换为json对象
            if (jsonData.error != null) {
                $.alert("[@s.m 'global.prompt'/]", jsonData.error);
            } else {
                addAttachLine();
                var index = attachIndex - 1;
                var attachUrl = jsonData.attachUrl;
                var attachName = jsonData.attachName;
                $("#attachmentPaths" + index).val(attachUrl);
                $("#attachmentNames" + index).val(attachName);
            }
        }

    </script>
</head>


<body style="width:100%;min-width:1200px;">

<div style="font-size: 16px;color: #707070;padding: 20px 0;width: 1200px;
            margin: 0 auto;">
    <!-- <a href="${base}/gylxt/index.jhtml" style="color: #3077b9;">供应链协同</a><a href="${base}/gylxtZxzy/index.jhtml"
                                                                             style="color: #3077b9;">&gt;众修资源</a>&gt;我要发布维修需求-->
    <a href="javascript:void(window.history.back())">返回</a>
</div>


<form id="inquiryForm" name="repairForm" class="form-horizontal" role="form" action="/member/demand_save.jspx"
      method="post">
    <input type="hidden" name="expectPrice" id="expectPrice"/>
    <div class="inquiry_main">
        <div class="item">
            <div class="go-field-title">
                <h3><span id="span_inquiry_message">维修信息</span></h3>
            </div>
            <input type="hidden" value="${demand.repairId!}" name="repairId"/>
            <div class="form-group">
                <div class="col-sm-10">
                    <label class="col-sm-2 control-label" style="float:left;"><span style="color: red">*</span>
                        维修主题：</label>
                    <input id="repairName" name="repairName" class="form-control" type="text"
                           value="${demand.repairName!}">
                    </input>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10">
                    <label class="col-sm-2 control-label" style="float:left;"><span style="color: red">*</span>
                        维修类型：</label>
                    <input id="repairType" name="repairType" class="form-control" type="text"
                           value="${demand.repairType!}">
                    </input>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10">
                    <label class="col-sm-2 control-label"><span style="color: red">*</span> <span
                            id="span_inquiry">维修地点：</span></label>
                    <div class="inputs commentDiv" id="distpicker1" data-toggle="distpicker">
                        <select class="resourceAddInput" id="addrProvince" name="addrProvince" style="width: auto;"
                                data-province="${demand.addrProvince!}">
                        </select>
                        <select class="codeInput" id="addrCity" name="addrCity" style="width: auto; "
                                data-city="${demand.addrCity!}"></select>
                        <select data-district="${demand.addrCounty!}" class="codeInput" id="addrCounty"
                                name="addrCounty"
                                style="width: auto;"></select>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10">
                    <label class="col-sm-2 control-label"><span style="color: red">*</span> <span
                            id="span_endtime">开始日期：</span></label>
                    <input value="${demand.startDt?string('yyyy-MM-dd')}" id="startDt" name="startDt" type="date"
                           class="inputText form-control"
                           style="width: 250px;"/>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10">
                    <label class="col-sm-2 control-label"><span style="color: red">*</span> 截止日期：</label>
                    <input id="deadlineDt" name="deadlineDt" type="date"
                           value="${demand.deadlineDt?string('yyyy-MM-dd')}"
                           class="inputText form-control"
                           style="width: 250px;"/>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10">

                    <label class="col-sm-2 control-label"><span style="color:red">*</span> 是否加急：</label>
                    <label>
                        <input id="pt" name="isUrgency" type="radio" value="0"/>
                        普通</label>
                    <label>
                        <input id="jj" name="isUrgency" type="radio" value="1"/>
                        加急</label>
                    [#if demand.isUrgency =="0"]
                    <script>
                        $("#pt").attr("checked", 'checked');  </script>
                    [#elseif demand.isUrgency=="1"]
                    <script> $("#jj").attr("checked", "checked");</script>
                    [/#if]
                </div>
            </div>
        </div>
        <div class="item">
            <div class="go-field-title">
                <h3><span id="span_inquiry_release">维修需求信息</span></h3>
            </div>
            <div class="form-group">
                <div style="text-align : left;width: 85%;margin: auto; ">
                    <span style="color: red">*</span>
                    <span
                            style="color: red;">
                    <input type="button" onclick="addInquiryP()" id="butt1" class=" form_button" value="添加维修价对象">
                    </span>

                </div>
                <div class="flip-scroll col-sm-10" style=" left: 75px;top:10px">
                    <div style="overflow-y:auto; overflow-x:auto; width:1000px;">
                        <table class="table  table-striped table-condensed flip-content" id="table1" name="table1">
                            <thead class="flip-content bordered-palegreen">
                            <tr> <!-- <th class="numeric"> 序列 </th> -->
                                <!-- <th class="numeric"> 产品编号</th> -->
                                <th class="numeric"><span style="color: red">*</span>对象名称</th>
                                <th class="numeric"><span style="color: red">*</span>对象型号</th>
                                <th class="numeric"><span style="color: red">*</span>维修数量</th>
                                <th class="numeric"><span style="color: red">*</span>维修地点</th>
                                <th class="numeric">维修要求</th>
                                <th scope="col"><span style="color: red">*</span>期望价格(元)</th>

                            </tr>
                            </thead>
                            <tbody>
                            [#if OBJlist?size gt 0]
                            [#list OBJlist as c]
                            <tr name='addpro'>
                                <td name='indexId' style='display:none;'>
                                </td>
                                <td><input type="hidden" value="${c.repairObjid!}" name="repairObjids"/><input
                                        type='text' value='${c.repairName!}' placeholder='最多30字符' maxlength='30'
                                        onblur='minganci($(this).val(), this)' name='repairNameStr'
                                        id='capandproname' style='width:160px' class='go-input-common'/></td>
                                <td><input type='text' value='${c.machineType!}' placeholder='最多30字符' maxlength='30'
                                           style='width:160px'
                                           name='machineTypeStr' id='capandprocode'
                                           onBlur='javascript:validateCapandprocode(this.value)'
                                           class='go-input-common'/></td>
                                <td><input type='text' value='${c.repairNum!}' placeholder='必须为整数' maxlength='10'
                                           style='width:80px'
                                           name='repairNumStr' id='repairNumStr' class='go-input-common'
                                           onkeyup='calculation(this)'/></td>
                                <td><input type='text' value='${c.addrProvince!}' placeholder='' maxlength='10'
                                           style='width:90px'
                                           name='chargeunit' id='chargeunit' class='go-input-common'/></td>
                                <td><input type='text' value='${c.repairRequest!}' placeholder='型号、要求等,最多30字符'
                                           name='repairRequestStr'
                                           maxlength='30' class='go-input-common' style='width:160px'
                                           class='go-input-common'></td>
                                <td><input type='text' value='${c.expectPrice!}' name='expectPriceStr'
                                           id='expectPriceStr'
                                           validate='{maxDecimalLen:2}' maxlength='10' value='0' style='width:80px'
                                           class='go-input-common' onkeyup='calculation(this)'/><input type='hidden'
                                                                                                       name='subTotal'>
                                </td>
                            </tr>
                            [/#list]
                            [/#if]
                            </tbody>
                        </table>
                        <div style="text-align : right;width: 90%;margin: auto; "><span
                                style="color:#e56826;font-weight:bold;">期望总价:</span>&nbsp;&nbsp;<span id="total"
                                                                                                      style="color:#e56826;font-weight:bold;">0.00</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="item">
                <div class="form-group">
                    <div class="col-sm-10">

                        <label class="col-sm-2 control-label"><span style="color: red">*</span>是否显示期望报价：</label>
                        <label>
                            <input id="fshow" name="isShow" type="radio" value="0"/>
                            否</label>
                        <label>
                            <input id="yshow" name="isShow" type="radio" value="1"/>
                            是</label>
                        [#if demand.isShow=="0"]
                        <script>$("#fshow").attr("checked", true);</script>
                        [#elseif demand.isShow=="1"]
                        <script>$("#yshow").attr("checked", true);</script>
                        [/#if]
                    </div>
                </div>
            </div>
           <!-- <div class="service-content wrapper">
                &lt;!&ndash;附件上传div&ndash;&gt;
                <div class="uploadImgs">
                    <label><i>*</i>&nbsp;上传附件：</label>
                    <span>(可批量上传附件)</span>
                    <div class="upLoadDiv">
                        &nbsp;&nbsp;<span id="aspanButtonPlaceHolder"></span><br><br>
                        <span style="display: none;"><input class="cancel" id="abtnCancel" type="button" value="取消" onclick="swfu.cancelQueue();" disabled="disabled" /></span>
                        <div id="afsUploadProgress" style="display: none;"></div>
                        <table id="attachTable" border="0" class="fbgj-fj">
                            <tr>
                                <td align="center"></td>
                                <td align="center">附件名称&nbsp;</td>
                                <td align="center">路径&nbsp;</td>
                                <td align="center">重新上传</td>
                            </tr>
                            [#list demand.content.attachments as file]
                            <tr id="attachTr${file_index}">
                                <td align="center" width="50"><a onclick="$('#attachTr${file_index}').remove();" href="javascript:void(0);" class="pn-opt">删除</a></td>
                                <td align="center"><input type="text" id="attachmentNames${file_index}" name="attachmentNames" class="member-change" style="width:100px;height:24px;" value="${file.attachmentName}"/></td>
                                <td align="center"><input type="text" id="attachmentPaths${file_index}" name="attachmentPaths" class="member-change" style="width:130px;height:24px;" value="${file.attachmentPath}"/></td>
                                <td align="center">
                                <span id="afc${file_index}" style="position:relative;display:block;width:250px;">
                                <input type='text' id='attachmentText${file_index}' class="member-change" style="width:150px;height:24px;" />
                                <input class="browse" type='button' value='浏览' style="width:40px;height:24px;cursor:pointer;background:#3694d7;color:#fff;font-size:12px;cursor:pointer;"/>
                                <input onchange="$('#attachmentText${file_index}').val(this.value)" size="19" type="file" name="attachmentFile" id="attachmentFile${file_index}" style="height:28px;width:200px;opacity:0;filter:alpha(opacity=0);position:absolute;left:0;top:0;"/>
                                <input type="button" value="上传" onclick="uploadAttachment(${file_index});" style="width:40px;height:24px;cursor:pointer;background:#3694d7;color:#fff;font-size:12px;cursor:pointer;" />
                                </span>
                                    <input type="hidden" id="attachmentFilenames${file_index}" name="attachmentFilenames"/>
                                </td>
                            </tr>
                            [/#list]
                        </table>
                    </div>
                    <textarea id="attachTr" style="display:none">
                        <tr id="attachTr{0}">
                            <td align="center" width="50"><a onclick="$('#attachTr{0}').remove();" href="javascript:void(0);" class="pn-opt">删除</a></td>
                            <td align="center"><input type="text" id="attachmentNames{0}" name="attachmentNames" class="member-change" style="width:100px;height:24px;"/></td>
                            <td align="center"><input type="text" id="attachmentPaths{0}" name="attachmentPaths" class="member-change" style="width:130px;height:24px;"/></td>
                            <td align="center">
                                <span id="afc{0}" style="position:relative;display:block;width:250px;">
                                <input type='text' id='attachmentText{0}' class="member-change" style="width:150px;height:24px;" />
                                <input class="browse" type='button' value='浏览' style="width:40px;height:24px;cursor:pointer;background:#3694d7;color:#fff;font-size:12px;cursor:pointer;"/>
                                <input onchange="$('#attachmentText{0}').val(this.value)" size="19" type="file" name="attachmentFile" id="attachmentFile{0}" style="height:28px;width:200px;opacity:0;filter:alpha(opacity=0);position:absolute;left:0;top:0;"/>
                                <input type="button" value="上传" onclick="uploadAttachment({0});" style="width:40px;height:24px;cursor:pointer;background:#3694d7;color:#fff;font-size:12px;cursor:pointer;" />
                                </span>
                                <input type="hidden" id="attachmentFilenames{0}" name="attachmentFilenames"/>
                            </td>
                        </tr>
                    </textarea>
                    <script type="text/javascript">
                        var attachIndex = 1;
                        var attachTpl = $.format($("#attachTr").val());
                        function addAttachLine() {
                            $('#attachTable').append(attachTpl(attachIndex++));
                        }
                    </script>
                </div>
                &lt;!&ndash;图片上传div&ndash;&gt;
                <div class="uploadImgs">
                    <label><i>*</i>&nbsp;上传图片：</label>
                    <span>(最多可添加5张图片，建议上传400*400像素的图片，单张大小不超过2M)</span>
                    <div class="upLoadDiv">
                        &nbsp;&nbsp;<span id="spanButtonPlaceHolder"></span><br><br>
                        <span style="display: none;"><input class="cancel" id="btnCancel" type="button" value="取消" onclick="swfu.cancelQueue();" disabled="disabled" /></span>
                        <div id="fsUploadProgress" style="display: none;"></div>
                        [#list content.pictures as p]
                        <table id="picTable${p_index+3}" border="0"
                               style="float:left;">
                            <tr>
                                <td>
                                    <div><input type="text" id="uploadImgPath${p_index+3}" name="picPaths" value="${p.imgPath}" style="width:170px"/> <a href="javascript:void(0);" onclick="$('#picTable${p_index+3}').remove();" class="pn-opt">删除</a></div>
                                    <div>
								<span id="ufc${p_index+3}" style="position:relative">
								<input type='text' id='uploadFileText${p_index+3}' size="10" style="border:1px solid #c7c7c7;" />
								<input onchange="$('#uploadFileText${p_index+3}').val(this.value)" size="10" type="file" id="uploadFile${p_index+3}" class="file-button" style="width:200px;"/>
								</span>
                                        <input type="button" value="上传" onclick="upload(${p_index+3});" class="upload-button"/>
                                    </div>
                                    <div><textarea style="width:200px;height:60px;" name="picDescs" maxlength="255">${p.description!}</textarea></div>
                                </td>
                                <td><img id="preImg${p_index+3}" src="${p.imgPath!}" alt="预览" noResize="true" style="width:110px;height:110px;background-color:#ccc;border:1px solid #333"/></td>
                            </tr>
                        </table>
                        [/#list]
                    </div>
                    <div id="picBefore" style="clear:both"></div>
                    <div id="picTable" style="display:none;">
                        <table id="picTable{0}" border="0" cellpadding="0" cellspacing="0" class="fbgj-tab upLoadDiv">
                            <tr>
                                <td style="line-height:1;">
                                    <div><input type="text" id="uploadImgPath{0}" name="picPaths" class="member-change" /> <a href="javascript:void(0);" onclick="$('#picTable{0}').remove();" class="pn-opt">删除</a></div>
                                    <div style="margin-top:4px;">
                                        <span id="ufc{0}" style="position:relative;">
                                        <input type='text' id='uploadFileText{0}' size="10" class="member-change" style="width:115px;height:30px;"/>
                                        <input onchange="$('#uploadFileText{0}').val(this.value)" size="10" type="file" id="uploadFile{0}" style="width:72px;height:30px;"/>
                                        </span>
                                        <input type="button" value="重新上传" onclick="upload({0});" style="width:50px;height:30px;cursor:pointer;background:#3694d7;color:#fff;font-size:12px;"/>
                                    </div>
                                    <div><textarea style="width:300px;height:60px;margin-bottom:0;margin-top:10px;" name="picDescs" maxlength="255" ></textarea></div>
                                </td>
                                <td><img id="preImg{0}" alt="预览" noResize="true" style="width:110px;height:110px;background-color:#ccc;border:1px solid #c7c7c7;"/></td>
                            </tr>
                        </table>
                    </div>
                    <script type="text/javascript">
                        var picIndex = 1;
                        var picTpl = $.format($("#picTable").html());
                        function addPicLine() {
                            $('#picBefore').before(picTpl(picIndex++));
                        }
                    </script>
                </div>
            </div>-->
                <!--  <div class="form-group">
                      <div class="col-sm-10">
                          <label class="col-sm-2 control-label"> 附件：</label>
                          <a href="javascript:selectIconFile();" class="btn-ctrl" id="addFile" js_tukubtn="true"
                             class="form-control">添加附件</a>
                          <a target="_blank" id='spanFile'></a>
                          <div id='delFile' style='display: none;'><a href='javascript:void(0)' onclick='relFile(this)'>删除</a>
                          </div>
                          <span style="color: #aaaaaa">(需求详细信息、要求等以附件形式上传，大小不超过10M，格式限word、excel、pdf等)</span></div>
                      <input type="hidden" id="attachment" name="attachment">
                      <input type="hidden" name="fileName" id="fileName"/>
                  </div>-->
                <!--  <div class="form-group">
                      <div class="col-sm-10">
                          <label class="col-sm-2 control-label">上传图片：</label>
                          <a href="javascript:openImageDialog();" class="btn-ctrl"
                             id="addProductPic" js_tukubtn="true">添加图片</a><span style="color: #aaaaaa">(建议上传400*400像素的图片，大小不超过2M，图片类型必须是(gif,jpeg,jpg,bmp,png)中的一种)</span>
                          <div class="addproduct-pic" id="picView" style="margin-left: 120px"></div>
                      </div>
                  </div>-->

                <div class="form-group">
                    <div class="col-sm-10">
                        <label class="col-sm-2 control-label"><span style="color: red">*</span>补充说明：</label>

                        <input id="description" name="description" class="form-control" class="required"
                               style="width: 450px;">
                    </div>
                </div>
            </div>

            <!--  <div class="item">
                  <div class="go-field-title">
                      <h3>商务条款</h3>
                  </div>
                  <div class="form-group">
                      <div class="col-sm-10">
                          <label class="col-sm-2 control-label"><span style="color: red">*</span> 交易方式：</label>

                          <label>
                              <input id="货到付款" name="dealType" type="checkbox" value="货到付款"/>
                              货到付款</label>
                          <label>
                              <input id="预付款" name="dealType" type="checkbox" value="预付款"/>
                              预付款</label>
                          <label>
                              <input id="其它" name="dealType" type="checkbox" value="其它"/>
                              其他</label>
                          <span></span></div>
                      <script>
                          $("#" + "${demand.dealType!}").attr("checked", true);
                      </script>
                  </div>
                  <div class="form-group">
                      <div class="col-sm-10">
                          <label class="col-sm-2 control-label"><span style="color: red">*</span> 付款方式：</label>

              <span>
              <input id="现金" name="payType" value="现金" type="radio"/>
              现金</span> <span>
              <input id="银行转账" name="payType" value="转账" type="radio"/>
              银行转账</span> <span>
              <input id="支票" name="payType" value="支票" type="radio"/>
              支票</span> <span>
              <input id="汇票" name="payType" value="汇票" type="radio"/>
              汇票</span> <span>
              <input id="本票" name="payType" value="本票" type="radio"/>
              本票</span> <span>
              <input id="其他" name="payType" value="其他" type="radio"/>
              其他</span>
                          <script>
                              $("#" + "${demand.payType!}").attr("checked", true);
                          </script>
                      </div>
                  </div>
                  <div class="form-group">
                      <div class="col-sm-10">
                          <label class="col-sm-2 control-label"><span style="color: red">*</span> 发票类型：</label>

              <span>

              <input id="无需发票" name="invoiceType" value="无" type="radio"/>
              无需发票</span>
              <span>
              <input id="普通发票" name="invoiceType" value="普通发票" type="radio"/>
              普通发票</span>
              <span>
              <input id="增值税发票" name="invoiceType" value="增值税发票" type="radio"/>
              增值税发票</span>
                          <script>
                              $("#" + "${demand.invoiceType!}").attr("checked", true);
                          </script>
                      </div>
                  </div>


              </div>-->
            <div class="item">
                <div class="go-field-title"><h3>联系方式</h3></div>
                <div class="form-group">
                    <div class="col-sm-10">
                        <label class="col-sm-2 control-label" style="float:left;"><span
                                style="color: red">*</span>联系人:</label>
                        <input id="contact" name="contact" class="form-control" style="width: 150px;"
                               validate="{required:true,maxlength:40}" value="${demand.contact!}"/>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-10">
                        <label class="col-sm-2 control-label" style="float:left;"><span
                                style="color: red">*</span>联系电话:</label>
                        <input id="mobile" name="mobile" class="form-control phone" value="${demand.mobile!}"
                               onkeyup="value=value.replace(/[^\d]/g,'')"
                               onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))"
                               style="width: 150px;" validate="{maxlength:11,number:true  }"/>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-10">
                        <label class="col-sm-2 control-label" style="float:left;"><span
                                style="color: red">*</span>邮箱:</label>
                        <input id="email" name="email" class="form-control" style="width: 150px;"
                               validate="{email:true,maxlength:59}" value="${demand.email!}"/>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-10">
                        <label class="col-sm-2 control-label" style="float:left;"><span
                                style="color: red">*</span>传真:</label>
                        <input id="fax" name="fax" class="form-control fox" style="width: 150px;"
                               validate="{maxlength:40}"/><span></span>
                    </div>
                </div>
            </div>
            <div style="padding:30px 0 0 0; text-align:center; clear:both;">
                <input type="hidden" id="status" name="state">
                <button type="button" value="0" id="save" class="btns btn-warning" onclick="saveRepair(0)">保存草稿</button>
                <button type="button" value="1" id="save_rel" class="btns btn-warning" onclick="saveRepair(1)">发布需求</button>
            </div>
        </div>
        <input id="nextUrl" name="nextUrl" value="/" hidden="hidden">
        <input id="modelId" name="modelId" value="98" hidden="hidden">
        <input id="channelId" name="channelId" value="103" hidden="hidden">
</form>


<script charset="utf-8" src="/r/cms/www/default/resources/js/mapDistPicker/distpicker.data.js"
        type="text/javascript"></script>
<script charset="utf-8" src="/r/cms/www/default/resources/js/mapDistPicker/distpicker.js"
        type="text/javascript"></script>
<script charset="utf-8" src="/${res}/resources/js/supply/supplyReleaseResource.js" type="text/javascript"></script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="/${res}/resources/lib/editor/lang/zh-cn/zh-cn.js"></script>
<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/breakingNews.js"></script>
<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/head.js"></script>
<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/userCenter.js"></script>
<!--富文本编辑，粘贴图片-->
<script type="text/javascript">
    var editor = UE.getEditor('editor',{autoHeightEnabled:false,zIndex:0});
    editor.ready(function() {
        editor.setContent("${content.txt!?default('')}");
    });
</script>
<script language="javascript">
    UE.Editor.prototype._bkGetActionUrl = UE.Editor.prototype.getActionUrl;
    UE.Editor.prototype.getActionUrl = function(action) {
        if (action == 'uploadimage' || action == 'uploadscrawl' || action == 'uploadimage') {
            return "/ueditor/upload.jspx";
        } else {
            return this._bkGetActionUrl.call(this, action);
        }
    }
</script>
</body>
</html>
