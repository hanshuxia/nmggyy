<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>政府网站添加</title>
    <link rel="shortcut  icon" type="image/x-icon" href="/${res}/resources/images/favicon.ico" media="screen"/>
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/base.css"/>
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/releasePower.css"/>
    <link href="/${res}/css/logistics/layer.css" type="text/css" rel="stylesheet">

    <!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/html5media/1.1.8/html5media.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>

    <![endif]-->

    <link href="${resSys}/jqueryUI/jquery.ui.css" rel="stylesheet" type="text/css"/>
    <script src="${resSys}/jquery.js" type="text/javascript"></script>
    <script src="${resSys}/front.js" type="text/javascript"></script>
    <script src="${base}/res/common/js/jquery.ext.js" type="text/javascript"></script>
    <script src="${resSys}/jqueryUI/jquery-ui.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/ckeditor/ckeditor.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/swfupload.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/swfupload.queue.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/fileprogress.js" type="text/javascript"></script>
    <script src="${base}/thirdparty/swfupload/handlers.js" type="text/javascript"></script>
    <link href="${base}/thirdparty/swfupload/process.css" rel="stylesheet" type="text/css"/>

    <!--日期插件-->
    <link rel="stylesheet" type="text/css" href="/${res}/resources/css/releasePower.css"/>
    <!--添加表单校验-->
    <script src="${base}/res/common/js/jquery.validate.js" type="text/javascript"></script>
    <script src="${base}/res/common/js/messages_zh.js" type="text/javascript"></script>
    <!--自己写校验方法-->
    <script type="text/javascript" charset="utf-8" src="/${res}/resources/js/validateCheck.js"></script>
    <script type="text/javascript" src="/${res}/js/logistics/ui.js"></script>
    <script type="text/javascript" src="/${res}/js/logistics/layer.js"></script>

    <style>
        .SDemandObj_input {
            line-height: 2em;
            height: 2em;
            text-align: center;
            margin: 5px;
            border: none
        }

        .SDemandObj_table {
            width: 90%;
            margin: auto;
            text-align: center;
            margin-top: 20px;
            line-height: 3em;
        }

        .wrapper {
            width: 1040px;
        }

        .likeMessage img {
            width: 190px;
        }

        .likeMessage {
            padding-left: 17px;
        }

    </style>
    <script type="text/javascript">
//        function validator() {
//          return  $("#site_form").validate();
//        }
        $().ready(function() {
            validform();
        });
        function validform(){
            /*关键在此增加了一个return，返回的是一个validate对象，这个对象有一个form方法，返回的是是否通过验证*/
            return $("#site_form").validate();
        }
    </script>
</head>
<body>

<div class="content wrapper">
    <form id="site_form" action="/member/siteOfGovernmentList_add_save.jspx" method="post">
        <!--需求信息-->
        <div class="servicePower">
            <div class="column wrapper"><span class="head">政府网站新增</span> <span class="tips"><i>*</i>&nbsp;为必填项</span>
            </div>
            <div class="service-content wrapper">
                <div>
                    <label><i>*</i>&nbsp;地区：</label>
                    <select name="addrProvince" disabled="disabled">
                        <option value="内蒙古自治区" selected="selected">内蒙古自治区</option>
                    </select>
                    <select name="address" id="address">
                        <option value="内蒙古自治区政府">内蒙古自治区政府</option>
                        <option value="呼和浩特市">呼和浩特市</option>
                        <option value="包头市">包头市</option>
                        <option value="鄂尔多斯市">鄂尔多斯市</option>
                        <option value="乌兰察布市">乌兰察布市</option>
                        <option value="乌海市">乌海市</option>
                        <option value="呼伦贝尔市">呼伦贝尔市</option>
                        <option value="通辽市">通辽市</option>
                        <option value="赤峰市">赤峰市</option>
                        <option value="巴彦淖尔市">巴彦淖尔市</option>
                        <option value="锡林郭勒盟">锡林郭勒盟</option>
                        <option value="兴安盟">兴安盟</option>
                        <option value="阿拉善盟">阿拉善盟</option>
                        <option value="政府采购网">政府采购网</option>
                    </select>&nbsp;&nbsp;&nbsp;&nbsp;
                </div>
                <div class="inputs">
                    <label><i>*</i>&nbsp;网站名称：</label>
                    <input class="power space" id="stiteName" maxlength="50" name="stiteName" type="text"
                           style="width: 500px;" required>
                </div>
                <div class="inputs">
                    <label><i>*</i>&nbsp;链接地址：</label>
                    <input class="power url" id="stiteAddress" maxlength="500" name="stiteAddress" type="text"
                           style="width: 500px;" placeholder="例如：http://www.baidu.com" required>
                </div>
            </div>
        </div>

        <div class="release-button">
            <div style="float: left;margin-left:22%">
                <button class="btn submit" type="button" onclick="grandSubCheck()">发布网站</button>
                <button type="button" class="btn cancel" onclick="saveDraft()">保存到草稿</button>
            </div>
        </div>
        <br>
        <br>
        <!--新增需传递默认参数：状态、操作类型、成功后返回地址-->
        <input type="hidden" id="status" name="status">
        <input type="hidden" name="operType" value="siteAdd">
    </form>
</div>

<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/head.js"></script>
<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/imgPage.js"></script>
<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/abilityPreview.js"></script>

<script type="text/javascript" charset="utf-8" src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script type="text/javascript" charset="utf-8" src="${base}/thirdparty/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="${base}/thirdparty/ueditor/ueditor.all.js"></script>
<script charset="utf-8" src="/r/cms/www/default/resources/js/mapDistPicker/distpicker.data.js"
        type="text/javascript"></script>
<script charset="utf-8" src="/r/cms/www/default/resources/js/mapDistPicker/distpicker.js"
        type="text/javascript"></script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="${base}/thirdparty/ueditor/lang/zh-cn/zh-cn.js"></script>
<script type="text/javascript" charset="utf-8" src="/${res}/resources/js/breakingNews.js"></script>
<script>
    function grandSubCheck() { // 政府网站新增保存
//        var tableForm = document.getElementById("site_form");
//        var siteName = document.getElementById("stiteName").value;
//        siteName = encodeURI(encodeURI(siteName));
//        var stiteAddress = document.getElementById("stiteAddress").value;
//        var address = document.getElementById("address").value;
//        address = encodeURI(encodeURI(address));
//        window.location.href = "../member/siteOfGovernmentList_add_save.jspx?stiteName=" + siteName + "&stiteAddress="
//                + stiteAddress + "&address=" + address + "&status=3" + "&nextUrl=siteOfGovernmentList.jspx&operType=siteAdd";
//        $('#site_form').action="/siteOfGovernmentList_add_save.jspx?stiteName=" + siteName + "&stiteAddress="
//        + stiteAddress + "&address=" + address + "&nextUrl=siteOfGovernmentList.jspx";
        $("#status").val("3");
        if (validform().form()) {
            $('.btn.submit').attr("disabled", true);
            $('.btn.cancel').attr("disabled", true);
            $('#site_form').submit();
        }
//        $('#site_form').submit();
    }

    function saveDraft() { // 保存到草稿
//        var siteName = document.getElementById("stiteName").value;
//        siteName = encodeURI(encodeURI(siteName));
//        var stiteAddress = document.getElementById("stiteAddress").value;
//        var address = document.getElementById("address").value;
//        address = encodeURI(encodeURI(address));
//        $('#site_form').action="/siteOfGovernmentList_add_save.jspx?stiteName=" + siteName + "&stiteAddress="
//        + stiteAddress + "&address=" + address + "&nextUrl=siteOfGovernmentList.jspx";
//        window.location.href = "../member/siteOfGovernmentList_add_save.jspx?stiteName=" + siteName + "&stiteAddress="
//                + stiteAddress + "&address=" + address + "&status=1" + "&nextUrl=siteOfGovernmentList.jspx&operType=siteAdd";
        if (validform().form()) {
            $("#status").val("1");
            $('#site_form').onsubmit = null;
            layer.confirm('确定保存到草稿？', {
                skin: 'layui-layer-lan',
                icon: 3,
                shift: -1,
                btn: ['确定', '取消']
            },
            function (index, layero) {
                $('.btn.submit').attr("disabled", true);
                $('.btn.cancel').attr("disabled", true);
                $('#site_form').submit();
            }, function (index) {
                layer.close(index);
                return false;
            });
        }
    }
</script>
</body>
</html>