var typeFrame=function(C,E,B,A,F){this.tCode=C;this.idcn=E;this.leftPx=B;this.oInputId=A;this.hInputId=F;var D=$("<div class='choose-catagory-layout' id='"+this.oInputId+"Catagory' style='position:absolute; display: none; left: "+this.leftPx+"px'><div class='catagory-columns'></div><div class='text-center'><input type='button' style='width: 80px;'  value='确定' onclick=\"setCataCode(this, '"+this.oInputId+"', '"+this.hInputId+"')\" /><input type='button' style='width: 80px; margin-left:30px;' id='clearBtn' value='清空' onclick=\"clearCataCode(this, '"+this.oInputId+"', '"+this.hInputId+"')\" /></div></div>");this.ini=function(){var H=this.oInputId;var G=this.hInputId;$("."+this.idcn).css("position","relative").append(D);$("#"+this.oInputId).click(function(I){$("#"+H+"Catagory").show();$("#"+H+"Catagory").css("top","36px");I.stopPropagation()}).attr("readonly","readonly");$(".choose-catagory-layout").click(function(I){I.stopPropagation()});$(document).click(function(){$(".choose-catagory-layout").find(".catagory-ul:first").find(".cataSelected").removeClass("cataSelected");$(".choose-catagory-layout").find(".catagory-ul:gt(0)").remove();$(".choose-catagory-layout").hide()});fillCatagory(this.tCode,this.oInputId,"grand",1)}};function fillCatagory(typeCode,outerInputId,parentKey,level){var layout=$("#"+outerInputId+"Catagory");if(level==1){layout.children(".catagory-columns").children(".catagory-ul").remove()}if(level>1){layout.children(".catagory-columns").children(".catagory-ul:gt("+(level-2)+")").remove()}$.ajax({type:"post",url:"/dict/getTypeCatagory.jsp?typeCode="+typeCode+"&parentKey="+parentKey,dataType:"json",success:function(json){if(eval(json.cataList).length>0){layout.children(".catagory-columns").append("<ul class='catagory-ul'></ul>");if(level>2){alert("最多支持三级菜单！第四级菜单将无法显示！");return false}var newcol=layout.find(".catagory-ul:last");$.each(json.cataList,function(i,item){newcol.append("<li class='catagory-li' id='oid"+item.key+"' onclick=\"selectCata('"+typeCode+"','"+outerInputId+"',this)\">"+item.value+"</li>")})}},error:function(){}})}function selectCata(B,A,E){$(E).siblings("li").removeClass("cataSelected");$(E).addClass("cataSelected");var C=$(E).parent().parent().children(".catagory-ul").index($(E).parent())+2;var D=$(E).attr("id").substring(3);fillCatagory(B,A,D,C)}function setCataCode(G,C,E){var D=false;var B=$(G).parent().parent().find(".catagory-ul");var A=[];var F="";$.each(B,function(H,I){var J=$(I).find(".cataSelected");if(J.size()<1){D=true;return false}A[H]=J.text();if(H==B.length-1){F=J.attr("id").substring(3)}});if(D){alert("存在未选择的子项！请检查。");return false}$("#"+C).val(A.join(" > "));$("#"+E).val(F);$(G).parent().parent().hide();abilityType();}function clearCataCode(C,A,B){$("#"+A).val("");$("#"+B).val("");$(C).parent().parent().find(".catagory-ul:first").find(".cataSelected").removeClass("cataSelected");$(C).parent().parent().find(".catagory-ul:gt(0)").remove();$(C).parent().parent().hide()};